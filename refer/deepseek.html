<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D 星空互动场景</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            overflow: hidden;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            font-family: 'Arial', sans-serif;
            color: white;
        }
        
        #container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        #title {
            position: absolute;
            top: 20px;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 2.5rem;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.7);
            z-index: 100;
            letter-spacing: 2px;
        }
        
        #instructions {
            position: absolute;
            bottom: 30px;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 1.1rem;
            background: rgba(0, 0, 0, 0.6);
            padding: 15px;
            border-radius: 10px;
            max-width: 600px;
            margin: 0 auto;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            line-height: 1.6;
        }
        
        #instructions span {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 10px;
            border-radius: 5px;
            margin: 0 5px;
        }
        
        #loading {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 200;
            transition: opacity 1s;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #4b6cb7;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        #loading h2 {
            margin-top: 20px;
            color: #fff;
            font-size: 1.8rem;
        }
        
        .hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        #stars-count {
            position: absolute;
            top: 80px;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.7);
            z-index: 100;
        }
        
        #galaxy-title {
            position: absolute;
            top: 120px;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 1.5rem;
            color: #4b6cb7;
            text-shadow: 0 0 10px rgba(75, 108, 183, 0.5);
            z-index: 100;
        }
    </style>
</head>
<body>
    <div id="loading">
        <div class="spinner"></div>
        <h2>正在初始化星空场景...</h2>
    </div>
    
    <div id="title">探索无尽星空</div>
    <div id="stars-count">10,000 颗星星正在闪耀</div>
    <div id="galaxy-title">银河系旋臂</div>
    
    <div id="container"></div>
    
    <div id="instructions">
        使用鼠标 <span>左键拖动</span> 旋转视角 | 
        <span>滚轮滚动</span> 缩放 | 
        <span>右键拖动</span> 平移
    </div>
    
    <script>
        // 初始化场景
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x000011);
        
        // 初始化相机
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 2000);
        camera.position.z = 200;
        
        // 初始化渲染器
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        document.getElementById('container').appendChild(renderer.domElement);
        
        // 添加轨道控制器
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        
        // 创建星星粒子系统
        function createStars() {
            const starsGeometry = new THREE.BufferGeometry();
            const starsMaterial = new THREE.PointsMaterial({
                color: 0xffffff,
                size: 0.7,
                transparent: true,
                opacity: 0.8
            });
            
            const starsVertices = [];
            const starsColors = [];
            
            // 创建10,000颗星星
            for (let i = 0; i < 10000; i++) {
                const x = THREE.MathUtils.randFloatSpread(2000);
                const y = THREE.MathUtils.randFloatSpread(2000);
                const z = THREE.MathUtils.randFloatSpread(2000);
                
                starsVertices.push(x, y, z);
                
                // 随机颜色（主要是白色，部分偏蓝或黄）
                const color = new THREE.Color();
                const rand = Math.random();
                if (rand > 0.9) {
                    color.setRGB(0.8, 0.8, 1.0); // 偏蓝色星星
                } else if (rand > 0.8) {
                    color.setRGB(1.0, 1.0, 0.7); // 偏黄色星星
                } else {
                    color.setRGB(1, 1, 1); // 白色星星
                }
                
                starsColors.push(color.r, color.g, color.b);
            }
            
            starsGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starsVertices, 3));
            starsGeometry.setAttribute('color', new THREE.Float32BufferAttribute(starsColors, 3));
            
            const starField = new THREE.Points(starsGeometry, starsMaterial);
            scene.add(starField);
        }
        
        // 创建银河系旋臂
        function createGalaxy() {
            const galaxyGroup = new THREE.Group();
            
            // 银河系中心球体
            const coreGeometry = new THREE.SphereGeometry(20, 32, 32);
            const coreMaterial = new THREE.MeshBasicMaterial({
                color: 0xffff00,
                transparent: true,
                opacity: 0.7
            });
            const core = new THREE.Mesh(coreGeometry, coreMaterial);
            galaxyGroup.add(core);
            
            // 创建旋臂粒子
            const armGeometry = new THREE.BufferGeometry();
            const armMaterial = new THREE.PointsMaterial({
                size: 1.5,
                vertexColors: true,
                transparent: true,
                opacity: 0.9
            });
            
            const armVertices = [];
            const armColors = [];
            
            // 创建旋臂
            for (let arm = 0; arm < 4; arm++) {
                const angleOffset = (arm * Math.PI) / 2;
                
                for (let i = 0; i < 1500; i++) {
                    const radius = 30 + i * 0.1;
                    const angle = angleOffset + (i * 0.02) + Math.sin(i * 0.05) * 0.5;
                    
                    const x = Math.cos(angle) * radius;
                    const y = Math.sin(angle) * radius * 0.2;
                    const z = Math.sin(angle) * radius;
                    
                    armVertices.push(x, y, z);
                    
                    // 颜色渐变 - 从中心黄色到边缘蓝色
                    const color = new THREE.Color();
                    const t = i / 1500;
                    color.r = 1.0 * (1 - t) + 0.4 * t;
                    color.g = 0.8 * (1 - t) + 0.6 * t;
                    color.b = 0.2 * (1 - t) + 1.0 * t;
                    
                    armColors.push(color.r, color.g, color.b);
                }
            }
            
            armGeometry.setAttribute('position', new THREE.Float32BufferAttribute(armVertices, 3));
            armGeometry.setAttribute('color', new THREE.Float32BufferAttribute(armColors, 3));
            
            const galaxyArms = new THREE.Points(armGeometry, armMaterial);
            galaxyGroup.add(galaxyArms);
            
            scene.add(galaxyGroup);
            return galaxyGroup;
        }
        
        // 添加环境光
        const ambientLight = new THREE.AmbientLight(0x333333);
        scene.add(ambientLight);
        
        // 创建星星和银河系
        createStars();
        const galaxy = createGalaxy();
        
        // 添加闪烁星星效果
        function addTwinklingEffect() {
            const stars = scene.children.filter(child => child instanceof THREE.Points);
            
            stars.forEach(starField => {
                const positions = starField.geometry.attributes.position.array;
                const originalY = [...positions];
                
                starField.userData.originalPositions = originalY;
                starField.userData.offset = Math.random() * 100;
            });
        }
        
        // 窗口大小调整处理
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
        
        // 动画循环
        let lastTime = 0;
        function animate(time) {
            requestAnimationFrame(animate);
            
            // 计算时间增量
            const delta = time - lastTime;
            lastTime = time;
            
            // 旋转银河系
            if (galaxy) {
                galaxy.rotation.y += delta * 0.0001;
            }
            
            // 星星闪烁效果
            const stars = scene.children.filter(child => child instanceof THREE.Points);
            stars.forEach(starField => {
                const positions = starField.geometry.attributes.position.array;
                const originalPositions = starField.userData.originalPositions;
                const offset = starField.userData.offset || 0;
                
                for (let i = 0; i < positions.length; i += 3) {
                    // 只改变Y坐标来模拟闪烁
                    positions[i + 1] = originalPositions[i + 1] + Math.sin(time * 0.001 + i * 0.01 + offset) * 2;
                }
                
                starField.geometry.attributes.position.needsUpdate = true;
            });
            
            controls.update();
            renderer.render(scene, camera);
        }
        
        // 开始动画
        setTimeout(() => {
            document.getElementById('loading').classList.add('hidden');
            addTwinklingEffect();
            animate(0);
        }, 2000);
    </script>
</body>
</html>