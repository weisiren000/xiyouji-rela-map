# MEM141: 组件文件夹化重构记忆

## 🧠 核心记忆要点

### 用户偏好记忆
- **细粒度组织偏好**: 用户明确要求"仪表盘里面再分不同仪表盘的方法"，每个独立面板都要有自己的文件夹
- **功能完整性优先**: 重构过程中必须保持现有功能不被破坏
- **标准化结构**: 偏好统一的组件文件夹内部结构和命名规范
- **分阶段实施**: 喜欢渐进式重构，避免一次性大规模修改

### 技术实施记忆

#### 目录架构设计
```
src/components/
├── controls/           # 控制面板组件群
│   ├── CharacterControlPanel/
│   ├── ControlPanel/
│   ├── ModelEffectGUI/
│   └── ModelGUIManager/
├── panels/            # 信息面板组件群
│   ├── CharacterDataPanel/
│   ├── CharacterDetailPanel/
│   └── CharacterInfoCard/
├── views/             # 视图组件群
│   ├── CharacterDetailView/
│   └── ModelQuickAccess/
├── indicators/        # 指示器组件群
│   ├── PerformanceDisplay/
│   ├── PortStatusIndicator/
│   └── CharacterInfoOverlay/
├── dashboard/         # 仪表盘组件群
│   ├── DataDashboard/
│   ├── DataLoader/
│   └── CharacterMapper/
└── three/             # 3D组件群
    ├── Effects/
    ├── Scenes/
    ├── Galaxy/
    └── ModelSystem/
```

#### 标准组件文件夹结构
```
ComponentName/
├── index.tsx                 # 导出文件
├── ComponentName.tsx         # 主组件文件
├── ComponentName.css         # 样式文件 (如果需要)
├── types.ts                  # 类型定义 (如果需要)
├── hooks/                    # 组件专用hooks (如果需要)
├── components/               # 子组件 (如果需要)
└── utils/                    # 组件工具 (如果需要)
```

#### 导出方式规范
- **export const组件**: `export { ComponentName } from './ComponentName'`
- **export default组件**: `export { default } from './ComponentName'`
- **混合导出**: `export { default, ComponentName } from './ComponentName'`

### 常见问题解决记忆

#### 导入路径问题
- 使用tsconfig.json中的路径别名：`@components/*`, `@/*`
- 相对路径用于同级组件引用
- 注意GLTFLoader等第三方库的正确导入路径

#### 导出方式错误
- 检查组件实际使用的导出方式（export const vs export default）
- 根据实际导出方式修复index.tsx文件
- 处理混合导出情况

#### TypeScript编译错误
- 未使用变量可以安全删除
- 类型不匹配需要仔细检查接口定义
- 导入路径错误需要逐个修复

### 工作流程记忆

#### 重构步骤
1. **分析现状**: 了解当前文件组织和依赖关系
2. **设计架构**: 基于功能域设计新的目录结构
3. **创建目录**: 按分类创建新的目录结构
4. **移动文件**: 逐步移动文件到对应位置
5. **修复导出**: 修复所有组件的导出方式
6. **更新导入**: 更新所有文件的导入路径
7. **验证功能**: 确保重构后功能正常

#### 验证方法
- TypeScript编译检查：`npx tsc --noEmit`
- 项目启动验证：`pnpm dev`
- 功能测试：逐个验证核心功能

### 项目特殊性记忆

#### 包管理器
- 根目录使用pnpm
- server目录使用npm
- 不要混用包管理器

#### 技术栈
- React + TypeScript + Three.js + Zustand
- 使用lil-gui进行调试界面
- 3D渲染是核心功能

#### 用户背景
- 高级程序员，有13岁女儿
- 重视代码质量和项目稳定性
- 偏好谨慎的开发方式
- 善于观察文件结构，思维灵活

### 后续工作指导记忆

#### 优先级排序
1. **紧急**: TypeScript编译错误修复
2. **重要**: 功能验证和测试
3. **一般**: 文档更新和代码优化

#### 关键检查点
- 所有组件能正确导入导出
- 项目能正常启动和运行
- 3D渲染功能正常工作
- 数据加载功能完整

#### 风险控制
- 保持功能完整性
- 分阶段验证
- 及时记录问题和解决方案
- 保留回滚方案

### 成功经验记忆

#### 有效策略
- 第一性原理思考，从基础需求出发
- 分阶段执行，降低风险
- 保持一致性，统一规范
- 用户需求导向，严格按要求执行

#### 避免的错误
- 一次性大规模修改
- 忽视导出方式差异
- 路径更新不完整
- 缺乏功能验证

这些记忆将帮助后续工作更高效地完成剩余任务，并为类似的重构工作提供参考。
