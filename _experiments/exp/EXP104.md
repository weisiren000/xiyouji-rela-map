# EXP104: 后端数据服务启动和端口配置

## 问题描述
用户反馈前端无法加载数据，发现后端服务器未启动。

## 问题分析
1. **后端服务未启动**: 需要启动Node.js数据服务器
2. **端口冲突**: 多个服务使用相同端口导致冲突
3. **API地址不匹配**: 前端调用地址与后端监听地址不一致

## 解决过程

### 1. 检查后端服务器代码
- 位置: `src/server/dataServer.js`
- 功能: Express服务器，提供JSON数据API
- 数据源: `docs/data/JSON/character` 和 `docs/data/JSON/character_alias`

### 2. 端口冲突解决
**端口使用情况**:
- 3000: 被其他服务占用
- 3001: 被其他服务占用  
- 3002: 前端开发服务器(Vite)
- 3003: ✅ 可用，分配给后端服务器

**修改配置**:
```javascript
// src/server/dataServer.js
const PORT = 3003 // 从3002改为3003
```

```typescript
// src/components/three/CharacterSpheres.tsx
const response = await fetch('http://localhost:3003/api/data/complete')
```

### 3. 启动后端服务
```bash
cd src/server
node dataServer.js
```

## API测试结果
```json
{
  "success": true,
  "data": {
    "totalCharacters": 150,
    "totalAliases": 332,
    "charactersByType": {
      "PROTAGONIST": 5,
      "DEITY": 71,
      "HUMAN": 44,
      "DEMON": 28,
      "DRAGON": 2
    },
    "powerDistribution": {
      "high": 35,
      "medium": 98,
      "low": 17
    }
  }
}
```

## 服务架构
- **前端**: http://localhost:3002 (Vite开发服务器)
- **后端**: http://localhost:3003 (Express数据服务器)
- **数据**: 本地JSON文件 (482个数据点)

## API端点
- `GET /api/data/complete` - 获取完整数据(角色+别名+统计)
- `GET /api/characters` - 获取角色数据
- `GET /api/aliases` - 获取别名数据
- `GET /api/stats` - 获取数据统计
- `POST /api/cache/refresh` - 刷新缓存

## 数据加载流程
1. 前端组件挂载时调用API
2. 后端读取JSON文件并转换格式
3. 生成3D位置坐标
4. 返回完整数据给前端渲染

## 状态
✅ 后端服务器启动成功
✅ API接口正常工作
✅ 数据加载完成(150角色+332别名)
✅ 端口冲突已解决
🔄 等待前端数据渲染确认
