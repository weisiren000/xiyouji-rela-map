# 西游记关系图谱项目结构

## 项目概述
本项目是一个西游记人物、事件、物品、地点和技能的关系图谱数据库。

## 目录结构

```
xiyouji-rela-map/
├── docs/
│   └── data/
│       └── dict/
│           ├── id_pub/                    # 原始ID格式数据
│           │   ├── artifact.jsonc        # 法宝数据
│           │   ├── character.jsonc       # 人物数据
│           │   ├── event.jsonc           # 事件数据
│           │   ├── item.jsonc            # 物品数据
│           │   ├── location.jsonc        # 地点数据
│           │   └── skill.jsonc           # 技能数据
│           ├── unid/                     # 唯一ID格式数据
│           │   ├── allunid.jsonc         # 统一合并数据文件（部分完整）
│           │   ├── allunid_status.jsonc  # 统一文件完整性状态报告
│           │   ├── data_index.jsonc      # 数据统计和索引文件
│           │   ├── artifact.jsonc        # 法宝数据（唯一ID格式）
│           │   ├── character.jsonc       # 人物数据（唯一ID格式）
│           │   ├── event.jsonc           # 事件数据（唯一ID格式）
│           │   ├── item.jsonc            # 物品数据（唯一ID格式）
│           │   ├── location.jsonc        # 地点数据（唯一ID格式）
│           │   └── skill.jsonc           # 技能数据（唯一ID格式）
│           ├── type/                     # 类型分类数据
│           │   ├── artifact.jsonc        # 法宝类型
│           │   ├── character.jsonc       # 人物类型
│           │   ├── event.jsonc           # 事件类型
│           │   ├── item.jsonc            # 物品类型
│           │   ├── location.jsonc        # 地点类型
│           │   └── skill.jsonc           # 技能类型
│           ├── level.jsonc               # 等级配置
│           ├── target.jsonc              # 目标配置
│           └── type.jsonc                # 类型配置
└── arc.md                               # 项目结构文档
```

## 数据格式说明

### 唯一ID格式 (unid)
新创建的唯一ID格式采用以下结构：

#### 标准格式 (character, event, item, location, skill)
```jsonc
{
    "unid": {
        "0001": "项目名称", // 描述注释
        "0002": "项目名称", // 描述注释
        // ...
    },

    "aliases_unid": {
        "A0001": "别名1", // 对应主项目的别名
        "A0002": "别名2", // 对应主项目的别名
        // ...
    }
}
```

#### Artifact特殊格式
```jsonc
{
    "unid": {
        "A0001": "法宝名称", // 描述注释
        "A0002": "法宝名称", // 描述注释
        // ...
    },

    "aliases_unid": {
        "AA0001": "别名1", // 对应主法宝的别名
        "AA0002": "别名2", // 对应主法宝的别名
        // ...
    }
}
```

### 特点
- **标准主要ID**: 使用4位数字格式 "0001", "0002" 等
- **标准别名ID**: 使用 "A" + 4位数字格式 "A0001", "A0002" 等
- **Artifact主要ID**: 使用 "A" + 4位数字格式 "A0001", "A0002" 等
- **Artifact别名ID**: 使用 "AA" + 4位数字格式 "AA0001", "AA0002" 等
- **注释**: 每个条目都包含详细的中文注释说明
- **结构化**: 别名与主条目通过注释建立关联关系

## 数据内容

### 人物数据 (character.jsonc)
- 包含150个主要人物
- 332个别名
- 涵盖主角团队、神仙、妖怪、配角等

### 事件数据 (event.jsonc)
- 包含55个主要事件
- 170个别名
- 按取经路线时间顺序组织

### 法宝数据 (artifact.jsonc)
- 包含67个法宝
- 186个别名
- 涵盖武器、法器、宝物等

### 物品数据 (item.jsonc)
- 包含64个物品
- 149个别名
- 主要是丹药、仙果、草药等

### 地点数据 (location.jsonc)
- 包含70个地点
- 192个别名
- 涵盖天庭、人间、地府各界

### 技能数据 (skill.jsonc)
- 包含65个技能
- 197个别名
- 涵盖法术、神通、武技等

## 更新日志

### 统一数据文件 (allunid.jsonc)
- **文件位置**: `docs/data/dict/unid/allunid.jsonc`
- **文件描述**: 包含所有6个类型数据的统一合并文件（100%完整）
- **数据结构**: 按类型分组，保持原有ID格式和别名系统
- **完整数据**: 471个实体 + 1122个别名 = 1593条记录（100%完整度）
- **包含类型**: character, event, artifact, item, location, skill
- **完整状态**: 所有类型均100%完整
- **文件大小**: 约1582行，130KB
- **状态文件**: `allunid_status.jsonc` 详细记录完整性状态

### 数据索引文件 (data_index.jsonc)
- **文件位置**: `docs/data/dict/unid/data_index.jsonc`
- **文件描述**: 提供完整的数据统计、索引映射和查询指南
- **包含内容**: 文件统计、ID系统、路径索引、完整性检查
- **总计数据**: 471个实体 + 1122个别名 = 1593条记录（基于原始文件）
- **用途**: 数据概览、快速定位、性能优化指导

### 2024年最新更新
- ✅ 创建了完整的唯一ID格式数据文件
- ✅ 为所有6个类别建立了统一的ID结构
- ✅ 添加了详细的中文注释和别名系统
- ✅ 保持了与原始数据的完整对应关系
- ✅ 调整了artifact.jsonc的ID格式：主条目使用"A0001"，别名使用"AA0001"
- ✅ 创建了allunid.jsonc统一数据文件（100%完整）
- ✅ 补充了完整的地点别名数据（la0031-la0192）
- ✅ 补充了完整的技能别名数据（sa0031-sa0197）
- ✅ 创建了data_index.jsonc数据索引和统计文件
- ✅ 创建了allunid_status.jsonc完整性状态报告
- ✅ 实现了100%数据完整性，包含全部1593条记录
- 📋 提供了完整的数据使用指南和最佳实践建议

## 使用说明

1. **原始格式**: 使用 `docs/data/dict/id_pub/` 下的文件
2. **唯一ID格式**: 使用 `docs/data/dict/unid/` 下的文件
3. **统一数据文件**: 使用 `docs/data/dict/unid/allunid.jsonc` 获取大部分数据
4. **数据索引**: 使用 `docs/data/dict/unid/data_index.jsonc` 获取完整统计
5. **类型分类**: 参考 `docs/data/dict/type/` 下的文件

### 推荐使用方式

#### 根据需求选择文件
- **完整功能**: 使用allunid.jsonc统一文件（100%完整）或对应类型的单独文件
- **快速开发**: 使用allunid.jsonc统一文件（推荐）
- **数据统计**: 使用data_index.jsonc索引文件
- **状态检查**: 参考allunid_status.jsonc状态报告

#### 具体场景建议
- **所有类型数据查询**: allunid.jsonc统一文件（推荐）
- **单类型高频查询**: 对应的单独文件（性能优化）
- **关系建立**: 基于allunid.jsonc的统一ID系统
- **跨类型分析**: allunid.jsonc统一文件

#### 数据完整性说明
- ✅ **所有类型**: character, event, artifact, item, location, skill（100%完整）
- ✅ **统一文件**: allunid.jsonc包含所有1593条记录
- 📋 **详细状态**: 查看allunid_status.jsonc文件

## 数据特色

- **全面性**: 覆盖西游记中的主要元素
- **结构化**: 统一的ID和别名系统
- **可扩展**: 支持后续数据添加和关系建立
- **中文友好**: 完整的中文注释和说明

## 数据结构优化方案 (2024年最新)

### 优化背景
经过深入分析，发现当前数据结构存在以下问题：
1. **数据结构不一致**: `data_struc_demo.md` 示例与实际 JSONC 文件不匹配
2. **关系数据缺失**: 只有实体数据，缺少实体间关系，无法构建真正的关系图谱
3. **可视化数据不完整**: 缺少位置、颜色、布局等可视化必需数据

### 优化方案文档
- **优化设计**: `docs/data/optimized_data_structure.md`
- **实施计划**: `docs/data/implementation_plan.md`
- **关系数据示例**: `docs/data/dict/unid/relationships_demo.jsonc`

### 核心改进点
1. **分离关注点**: 实体数据、关系数据、可视化数据、配置数据分离
2. **完整关系系统**: 师徒、同门、家族、敌对等多种关系类型
3. **丰富可视化**: 位置、颜色、动画、主题等完整可视化配置
4. **性能优化**: 索引系统、预计算查询、按需加载

### 实施策略
采用**渐进式优化**策略，分4个阶段实施：
- 阶段1: 修复数据结构不一致 (1周)
- 阶段2: 构建核心关系数据 (2-3周)
- 阶段3: 添加可视化数据 (1-2周)
- 阶段4: 性能优化 (1周)

### 预期收益
- ✅ 支持完整的关系图谱功能
- ✅ 丰富的可视化效果和交互
- ✅ 高级查询和分析功能
- ✅ 优化的开发体验和系统性能

## 银河系可视化设计方案 (2024年最新)

### 设计理念
基于用户在 `docs/idea.md` 中的核心想法：
- **银河系旋臂效果**: 中心向外扩散的螺旋布局
- **双层视图系统**: 全景模式 ↔ 局部详细模式
- **九重天八圈分布**: 太阳 + 水金地火木土天海八大行星
- **点击进入局部视图**: 无缝场景切换体验

### 技术方案
**基础**: 改造 `refer/star_map.html` 的震撼视觉效果
**架构**: React + Vite + Three.js + Zustand (完全按照用户架构图)
**数据**: 读取现有 JSONC 文件，映射到银河系结构

### 核心创新点
1. **天体映射系统**: 471个实体按重要性和类型分配到9个天体
2. **螺旋布局算法**: 四条旋臂，重要角色靠近中心
3. **场景切换系统**: 点击角色进入关系详细视图
4. **九重天分层**: 垂直空间体现角色等级关系

### 实施文档
- **核心设计**: `docs/implementation/galaxy_xiyouji_design.md`
- **实施路线**: `docs/implementation/implementation_roadmap.md`
- **星图改造**: `docs/implementation/star_map_adaptation.md`

### MVP时间线
- **第1周**: 基础搭建 + 10个核心角色银河系布局
- **第2周**: 50个角色关系连线 + 信息面板
- **第3周**: 分类着色 + 关系区分 + 搜索功能
- **第4周**: 性能优化 + 响应式布局

### 预期效果
- 🌌 震撼的银河系旋臂视觉效果
- 🎯 完美的双层视图交互体验
- 📊 数据驱动的智能布局算法
- 🚀 高性能的Three.js渲染系统
