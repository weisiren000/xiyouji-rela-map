{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://xiyouji-rela-map.com/schemas/visual_config.json",
  "title": "西游记可视化配置Schema",
  "description": "定义西游记关系图谱中可视化配置的结构和验证规则",
  "type": "object",
  "properties": {
    "metadata": {
      "$ref": "#/definitions/metadata"
    },
    "themes": {
      "type": "object",
      "patternProperties": {
        "^[a-zA-Z][a-zA-Z0-9]*$": {
          "$ref": "#/definitions/theme"
        }
      },
      "additionalProperties": false
    },
    "entityVisualConfig": {
      "type": "object",
      "patternProperties": {
        "^[a-zA-Z_][a-zA-Z0-9_]*$": {
          "$ref": "#/definitions/entityVisualConfig"
        }
      },
      "additionalProperties": false
    },
    "relationshipVisualConfig": {
      "type": "object",
      "patternProperties": {
        "^[a-zA-Z][a-zA-Z0-9]*$": {
          "$ref": "#/definitions/relationshipVisualConfig"
        }
      },
      "additionalProperties": false
    },
    "animationConfig": {
      "$ref": "#/definitions/animationConfig"
    },
    "performanceConfig": {
      "$ref": "#/definitions/performanceConfig"
    }
  },
  "required": ["metadata", "themes"],
  "additionalProperties": false,
  "definitions": {
    "metadata": {
      "type": "object",
      "properties": {
        "version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+(\\.\\d+)?$"
        },
        "description": {
          "type": "string",
          "minLength": 1
        },
        "themes": {
          "type": "integer",
          "minimum": 1
        },
        "lastUpdated": {
          "type": "string",
          "format": "date-time"
        },
        "structureVersion": {
          "type": "string"
        }
      },
      "required": ["version", "description", "lastUpdated"],
      "additionalProperties": false
    },
    "theme": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1,
          "maxLength": 50
        },
        "description": {
          "type": "string",
          "minLength": 1,
          "maxLength": 200
        },
        "background": {
          "$ref": "#/definitions/background"
        },
        "entityOverrides": {
          "type": "object",
          "patternProperties": {
            "^[a-zA-Z_][a-zA-Z0-9_]*$": {
              "type": "object",
              "patternProperties": {
                "^[a-zA-Z_][a-zA-Z0-9_]*$": {
                  "type": "string",
                  "pattern": "^#[0-9A-Fa-f]{6}$"
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },
        "effects": {
          "$ref": "#/definitions/effects"
        }
      },
      "required": ["name", "description", "background"],
      "additionalProperties": false
    },
    "background": {
      "type": "object",
      "properties": {
        "color": {
          "type": "string",
          "pattern": "^#[0-9A-Fa-f]{6}$"
        },
        "gradient": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^#[0-9A-Fa-f]{6}$"
          },
          "minItems": 2,
          "maxItems": 5
        },
        "stars": {
          "$ref": "#/definitions/stars"
        }
      },
      "required": ["color"],
      "additionalProperties": false
    },
    "stars": {
      "type": "object",
      "properties": {
        "count": {
          "type": "integer",
          "minimum": 0,
          "maximum": 50000
        },
        "color": {
          "type": "string",
          "pattern": "^#[0-9A-Fa-f]{6}$"
        },
        "twinkle": {
          "type": "boolean"
        },
        "speed": {
          "type": "number",
          "minimum": 0,
          "maximum": 5
        }
      },
      "required": ["count", "color"],
      "additionalProperties": false
    },
    "effects": {
      "type": "object",
      "properties": {
        "bloom": {
          "$ref": "#/definitions/bloomEffect"
        },
        "film": {
          "$ref": "#/definitions/filmEffect"
        },
        "godRays": {
          "$ref": "#/definitions/godRaysEffect"
        },
        "distortion": {
          "$ref": "#/definitions/distortionEffect"
        },
        "waterRipple": {
          "$ref": "#/definitions/waterRippleEffect"
        }
      },
      "additionalProperties": false
    },
    "bloomEffect": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "strength": {
          "type": "number",
          "minimum": 0,
          "maximum": 5
        },
        "radius": {
          "type": "number",
          "minimum": 0,
          "maximum": 2
        },
        "threshold": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      },
      "required": ["enabled"],
      "additionalProperties": false
    },
    "filmEffect": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "noise": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "scanlines": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "intensity": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      },
      "required": ["enabled"],
      "additionalProperties": false
    },
    "godRaysEffect": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "intensity": {
          "type": "number",
          "minimum": 0,
          "maximum": 2
        },
        "samples": {
          "type": "integer",
          "minimum": 10,
          "maximum": 200
        }
      },
      "required": ["enabled"],
      "additionalProperties": false
    },
    "distortionEffect": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "intensity": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "frequency": {
          "type": "number",
          "minimum": 0.1,
          "maximum": 10
        }
      },
      "required": ["enabled"],
      "additionalProperties": false
    },
    "waterRippleEffect": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "intensity": {
          "type": "number",
          "minimum": 0,
          "maximum": 2
        },
        "frequency": {
          "type": "number",
          "minimum": 0.1,
          "maximum": 5
        }
      },
      "required": ["enabled"],
      "additionalProperties": false
    },
    "entityVisualConfig": {
      "type": "object",
      "properties": {
        "defaultShape": {
          "type": "string",
          "enum": ["sphere", "cube", "diamond", "cylinder", "cone"]
        },
        "sizeRange": {
          "type": "array",
          "items": {
            "type": "number",
            "minimum": 0.1,
            "maximum": 10
          },
          "minItems": 2,
          "maxItems": 2
        },
        "colorScheme": {
          "type": "object",
          "patternProperties": {
            "^[a-zA-Z_][a-zA-Z0-9_]*$": {
              "type": "string",
              "pattern": "^#[0-9A-Fa-f]{6}$"
            }
          },
          "additionalProperties": false
        },
        "effects": {
          "$ref": "#/definitions/entityEffects"
        }
      },
      "required": ["defaultShape", "sizeRange"],
      "additionalProperties": false
    },
    "entityEffects": {
      "type": "object",
      "properties": {
        "glow": {
          "$ref": "#/definitions/glowEffect"
        },
        "pulse": {
          "$ref": "#/definitions/pulseEffect"
        },
        "trail": {
          "$ref": "#/definitions/trailEffect"
        },
        "rotation": {
          "$ref": "#/definitions/rotationEffect"
        },
        "sparkle": {
          "$ref": "#/definitions/sparkleEffect"
        }
      },
      "additionalProperties": false
    },
    "glowEffect": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "intensityRange": {
          "type": "array",
          "items": {
            "type": "number",
            "minimum": 0,
            "maximum": 2
          },
          "minItems": 2,
          "maxItems": 2
        },
        "colorSource": {
          "type": "string",
          "enum": ["primary", "secondary", "custom"]
        },
        "pulsing": {
          "type": "boolean"
        }
      },
      "required": ["enabled"],
      "additionalProperties": false
    },
    "pulseEffect": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "speed": {
          "type": "number",
          "minimum": 0.1,
          "maximum": 5
        },
        "amplitude": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "easing": {
          "type": "string",
          "enum": ["linear", "easeInOutSine", "easeInOutQuad", "easeInOutCubic"]
        }
      },
      "required": ["enabled"],
      "additionalProperties": false
    },
    "trailEffect": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "length": {
          "type": "integer",
          "minimum": 1,
          "maximum": 50
        },
        "opacity": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      },
      "required": ["enabled"],
      "additionalProperties": false
    },
    "rotationEffect": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "speed": {
          "type": "number",
          "minimum": 0.1,
          "maximum": 10
        },
        "axis": {
          "type": "array",
          "items": {
            "type": "number",
            "minimum": -1,
            "maximum": 1
          },
          "minItems": 3,
          "maxItems": 3
        }
      },
      "required": ["enabled"],
      "additionalProperties": false
    },
    "sparkleEffect": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "frequency": {
          "type": "number",
          "minimum": 0.1,
          "maximum": 10
        },
        "intensity": {
          "type": "number",
          "minimum": 0,
          "maximum": 2
        }
      },
      "required": ["enabled"],
      "additionalProperties": false
    },
    "relationshipVisualConfig": {
      "type": "object",
      "properties": {
        "color": {
          "type": "string",
          "pattern": "^#[0-9A-Fa-f]{6}$"
        },
        "width": {
          "type": "number",
          "minimum": 0.1,
          "maximum": 10
        },
        "style": {
          "type": "string",
          "enum": ["solid", "dashed", "dotted"]
        },
        "animation": {
          "type": "string",
          "enum": ["pulse", "flow", "steady", "spark", "fade"]
        },
        "opacity": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "flow": {
          "$ref": "#/definitions/flowEffect"
        }
      },
      "required": ["color", "width", "style"],
      "additionalProperties": false
    },
    "flowEffect": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "speed": {
          "type": "number",
          "minimum": 0.1,
          "maximum": 5
        },
        "direction": {
          "type": "string",
          "enum": ["fromTo", "toFrom", "bidirectional"]
        },
        "effect": {
          "type": "string",
          "enum": ["normal", "lightning", "particles"]
        }
      },
      "required": ["enabled"],
      "additionalProperties": false
    },
    "animationConfig": {
      "type": "object",
      "properties": {
        "transitions": {
          "$ref": "#/definitions/transitions"
        },
        "interactions": {
          "$ref": "#/definitions/interactions"
        }
      },
      "additionalProperties": false
    },
    "transitions": {
      "type": "object",
      "patternProperties": {
        "^[a-zA-Z][a-zA-Z0-9]*$": {
          "$ref": "#/definitions/transition"
        }
      },
      "additionalProperties": false
    },
    "interactions": {
      "type": "object",
      "patternProperties": {
        "^[a-zA-Z][a-zA-Z0-9]*$": {
          "$ref": "#/definitions/interaction"
        }
      },
      "additionalProperties": false
    },
    "transition": {
      "type": "object",
      "properties": {
        "duration": {
          "type": "integer",
          "minimum": 100,
          "maximum": 10000
        },
        "easing": {
          "type": "string",
          "enum": ["linear", "easeInOutCubic", "easeInOutQuart", "easeInOutSine", "easeOutBack", "easeInOutExpo"]
        },
        "stagger": {
          "type": "integer",
          "minimum": 0,
          "maximum": 1000
        }
      },
      "required": ["duration", "easing"],
      "additionalProperties": true
    },
    "interaction": {
      "type": "object",
      "properties": {
        "duration": {
          "type": "integer",
          "minimum": 50,
          "maximum": 2000
        },
        "easing": {
          "type": "string",
          "enum": ["linear", "easeOutQuad", "easeOutQuint", "easeInOutSine"]
        },
        "scale": {
          "type": "number",
          "minimum": 0.1,
          "maximum": 5
        }
      },
      "required": ["duration", "easing"],
      "additionalProperties": true
    },
    "performanceConfig": {
      "type": "object",
      "properties": {
        "levelOfDetail": {
          "$ref": "#/definitions/levelOfDetail"
        },
        "culling": {
          "$ref": "#/definitions/culling"
        },
        "rendering": {
          "$ref": "#/definitions/rendering"
        }
      },
      "additionalProperties": false
    },
    "levelOfDetail": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "distances": {
          "type": "array",
          "items": {
            "type": "number",
            "minimum": 10,
            "maximum": 2000
          },
          "minItems": 2,
          "maxItems": 5
        },
        "qualities": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["high", "medium", "low"]
          },
          "minItems": 2,
          "maxItems": 5
        }
      },
      "required": ["enabled"],
      "additionalProperties": false
    },
    "culling": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "frustum": {
          "type": "boolean"
        },
        "occlusion": {
          "type": "boolean"
        }
      },
      "required": ["enabled"],
      "additionalProperties": false
    },
    "rendering": {
      "type": "object",
      "properties": {
        "maxEntities": {
          "type": "integer",
          "minimum": 100,
          "maximum": 10000
        },
        "maxRelationships": {
          "type": "integer",
          "minimum": 100,
          "maximum": 20000
        },
        "particleLimit": {
          "type": "integer",
          "minimum": 1000,
          "maximum": 50000
        }
      },
      "additionalProperties": false
    }
  }
}
